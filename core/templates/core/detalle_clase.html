{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Clase {{ clase.nombre }} - Legendaria</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: url("{% static 'core/img/Fondo_login.png' %}") no-repeat center center fixed;
            background-size: cover;
            backdrop-filter: blur(5px);
            color: white;
        }
        .card {
            background-color: rgba(0,0,0,0.7);
            border: none;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <h1>Clase: {{ clase.nombre }} ({{ clase.grado }})</h1>

        <h3 class="mt-4">Estudiantes:</h3>
        <ul class="list-group mb-4">
            {% for p in personajes %}
                <li class="list-group-item bg-dark text-white">{{ p.nombre_personaje }}</li>
            {% empty %}
                <li class="list-group-item bg-dark text-white">No hay estudiantes asignados.</li>
            {% endfor %}
        </ul>

        <a href="{% url 'crear_mision' clase.id %}" class="btn btn-primary my-3">Crear Nueva Misión</a>

        <h3>Misiones:</h3>
        <ul class="list-group mb-4">
            {% for m in misiones %}
                <li class="list-group-item bg-dark text-white">{{ m.titulo }} - {{ m.fecha_entrega }}</li>
            {% empty %}
                <li class="list-group-item bg-dark text-white">No hay misiones aún.</li>
            {% endfor %}
        </ul>

        <a href="#" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#crearMisionModal">Crear Nueva Misión</a>
        <a href="{% url 'panel_profesor' %}" class="btn btn-secondary">Volver</a>

        <!-- Modal para crear misión -->
        <div class="modal fade" id="crearMisionModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content bg-dark text-white">
              <div class="modal-header">
                <h5 class="modal-title">Crear Misión</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
              </div>
              <form method="post" action="{% url 'crear_mision' clase.id %}">
                {% csrf_token %}
                <div class="modal-body">
                  <div class="mb-3">
                    <label>Título</label>
                    <input type="text" class="form-control" name="titulo" required>
                  </div>
                  <div class="mb-3">
                    <label>Descripción</label>
                    <textarea class="form-control" name="descripcion" required></textarea>
                  </div>
                  <div class="mb-3">
                    <label>Fecha de entrega</label>
                    <input type="date" class="form-control" name="fecha_entrega" required>
                  </div>
                  <div class="mb-3">
                    <label>Puntos XP</label>
                    <input type="number" class="form-control" name="puntos_xp" required>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
              </form>
            </div>
          </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
